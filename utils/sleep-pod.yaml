apiVersion: v1
kind: Pod
metadata:
  name: debug
  labels:
    app: debug
spec:
  affinity:
    nodeAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        nodeSelectorTerms:
          - matchExpressions:
              - key: kubernetes.io/hostname
                operator: In
                values:
                  - marcus-server
  # imagePullSecrets:
  #   - name: gitea-pull-secrets
#  serviceAccountName: external-secrets
  containers:
  - name: debug
    image: ubuntu:latest
    command: ["/bin/sh", "-c", "sleep infinity"]
    # volumeMounts:
    # - mountPath: /credentials
    #   name: cloud-credentials
    # securityContext:
    #   runAsUser: 0
    #   runAsGroup: 0
    # resources:
    #   requests:
    #     memory: "64Mi"
    #     cpu: "250m"
    #   limits:
    #     memory: "128Mi"
    #     cpu: "500m"
    volumeMounts:
      - name: config
        mountPath: /pvc/config
      - name: old-config
        mountPath: /old/config
      - name: transcode
        mountPath: /pvc/transcode
      - name: old-transcode
        mountPath: /old/transcode
  restartPolicy: Never
  volumes:
  # - name: cloud-credentials
  #   secret:
  #     defaultMode: 420
  #     secretName: cloud-credentials
    - name: old-transcode
      hostPath: 
        path: /zpool/k8s/plex/transcode
    - name: old-config
      hostPath: 
        path: /zpool/k8s/plex/config
    - name: config
      persistentVolumeClaim:
        claimName: config
    - name: transcode
      persistentVolumeClaim:
        claimName: transcode

