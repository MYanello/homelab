apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

resources:
  - manifests/http-route.yaml

generators:
  - manifests/secret-generator.yaml

patches:
  - target:
      kind: StatefulSet
      name: vaultwarden
    patch: |-
      - op: add
        path: /metadata/annotations
        value: 
          backup.velero.io~1backup-volumes: data

helmCharts:
    - name: vaultwarden
      repo: https://guerzon.github.io/vaultwarden
      version: "0.34.4"
      releaseName: vaultwarden
      namespace: vaultwarden
      valuesFile: ./values.yaml
