resources:
  - ./cm.yaml
  - ./vs.yaml
# generators:
#   - ./secret-generator.yaml

# helmCharts:
#   - name: mend-renovate-ce
#     repo: https://mend.github.io/renovate-ce-ee
#     version: "9.4.0"
#     releaseName: mend-renovate-ce
#     namespace: renovate
#     valuesFile: ./values.yaml

patches:
  - path: ./ksops-patch.yaml
  - target:
      kind: Service
      name: argocd-server
    patch: |-
      - op: replace
        path: /spec/type
        value: LoadBalancer
      - op: add
        path: /metadata/annotations
        value: |
          metallb.universe.tf/loadBalancerIPs: 10.10.8.4
  - target:
      kind: ConfigMap
      name: argocd-cm
    patch: |-
      - op: add
        path: /data/
        value: |
          kustomize.buildOptions: --enable-helm --enable-alpha-plugins --enable-exec

#   - target:
#       kind: Deployment
#       name: mend-renovate-ce
#     patch: |-
#       - op: replace
#         path: /spec/revisionHistoryLimit
#         value: 3
