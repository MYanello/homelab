apiVersion: batch/v1
kind: CronJob
metadata:
  name: krr
  labels:
    app: krr
spec:
  schedule: "0 0 * * *"
  successfulJobsHistoryLimit: 3
  failedJobsHistoryLimit: 3
  jobTemplate:
    spec:
      ttlSecondsAfterFinished: 86400
      template:
        metadata:
          annotations:
            sidecar.istio.io/inject: "false"
          labels:
            app: krr
        spec:
          restartPolicy: Never
          containers:
          - name: krr
            image: robustadev/krr:v1.17.0@sha256:b2f4203e04dcc6324afe4504c18738a427386ffcf2bae2580c670fcf315ca07f
            imagePullPolicy: Always
            command:
              - /bin/sh
              - -c
              - "python krr.py simple   --max-workers 3 --width 2048 "
            resources:
              limits:
                memory: 2Gi
              requests:
                memory: 1Gi
          serviceAccountName: krr-service-account

